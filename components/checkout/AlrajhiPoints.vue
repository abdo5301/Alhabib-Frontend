<template>
  <!-- Mokafaah Description Block -->
  <div class="relative w-full bg-blue-800 rounded-md ps-3 lg:ps-[22px] pe-[30px] pt-3 pb-5">
    <div class="flex justify-start items-start w-full gap-8">
      <!-- Text -->
      <div class="flex flex-col justify-start items-start gap-1.5 text-white leading-5 w-[210px] md:w-[400px]">
        <span class="text-sm font-bold">{{ $t('mokafaah_payment_title') }}</span>
        <span class="lg:text-[13px] text-[10px] font-normal">{{ $t('mokafaah_payment_description') }}</span>
      </div>
      <!-- Mokafaa Logo -->
      <div
        class="absolute rtl:left-[75px] ltr:right-[75px] top-4 flex flex-col items-start justify-between h-8 text-white font-bold text-[10px]">
        <span>مكافأة</span>
        <span>mokafaah</span>
      </div>
      <!-- Modal toggle -->
      <div @click="modal.show()" class="absolute rtl:left-[108px] ltr:right-[108px] bottom-3">
        <button type="button"
          class="w-[52px] lg:w-[88px] h-[18px] flex justify-center items-center rounded-md shadow bg-white flex-shrink-0 text-blue-700 lg:text-xs text-[10px] leading-6 font-semibold">
          {{ $t('btn_add') }}
        </button>
      </div>
      <!-- Background Logo -->
      <div class="absolute rtl:left-0 ltr:right-0 bottom-0 ltr:scale-x-[-1]">
        <svg xmlns="http://www.w3.org/2000/svg" width="90" height="75" viewBox="0 0 90 75" fill="none">
          <path
            d="M63.1405 31.8459C66.7402 33.2691 70.2469 34.6544 73.752 36.0412C76.338 37.0645 78.9355 38.0747 81.5051 39.1175C86.1954 41.0208 88.9165 43.855 89.8177 47.524C89.9162 47.9253 89.9194 48.3408 89.9202 48.7497C89.9274 52.852 89.9473 56.9546 89.9166 61.0569C89.8959 63.8397 88.3647 66.2354 85.7555 68.331C84.3571 69.4542 82.6289 70.283 80.7726 71.0114C76.2227 72.796 71.6828 74.5932 67.1521 76.401C64.1713 77.5907 60.9625 78.1353 57.5327 78.0097C55.0193 77.9176 52.6156 77.4731 50.4236 76.6128C44.5781 74.3191 38.7474 72.0079 32.9335 69.6771C32.0809 69.3352 31.4477 69.2668 30.5198 69.6418C24.8326 71.9404 19.0904 74.175 13.3758 76.4415C10.4197 77.6139 7.23403 78.1323 3.84136 78.0106C0.903278 77.905 -1.78279 77.2315 -4.31453 76.2145C-8.92303 74.3629 -13.5945 72.5837 -18.168 70.6925C-23.5732 68.4574 -26.4861 65.1527 -26.5647 60.7872C-26.6353 56.8676 -26.5782 52.9472 -26.5798 49.0271C-26.581 46.223 -25.1694 43.7792 -22.5759 41.6387C-21.2225 40.5218 -19.56 39.6703 -17.7289 38.9495C-12.0039 36.6952 -6.30198 34.4131 -0.569365 32.1676C0.0495148 31.9252 0.218594 31.6552 0.216599 31.1992C0.196262 26.5498 0.113314 21.8993 0.231348 17.2513C0.337818 13.0639 3.00434 9.73845 8.2066 7.51783C12.3729 5.73926 16.6895 4.12673 20.9439 2.44608C22.0648 2.00349 23.1861 1.55898 24.3365 1.15468C26.1565 0.514869 28.1013 0.18771 30.1417 0.0484769C33.9188 -0.209747 37.3586 0.432809 40.6001 1.72229C45.134 3.52603 49.66 5.33934 54.2242 7.10615C57.9654 8.55455 60.5972 10.6318 62.1221 13.3771C62.7892 14.5782 63.1266 15.8311 63.1326 17.1115C63.1549 21.7609 63.1413 26.4103 63.1413 31.0597C63.1405 31.3081 63.1405 31.557 63.1405 31.8459ZM31.62 61.8978C31.7539 61.8724 31.789 61.8707 31.8165 61.8598C37.5623 59.5883 43.3492 57.3638 49.0359 55.0251C52.1734 53.7348 53.8338 51.7475 53.8362 49.1844C53.8402 44.8331 53.8278 40.4816 53.8514 36.1304C53.8537 35.6889 53.6647 35.4441 53.0921 35.2195C47.5936 33.064 42.1397 30.8543 36.6204 28.7242C33.2987 27.4424 29.8797 27.4946 26.568 28.7863C21.1492 30.9 15.7671 33.0582 10.3519 35.1765C9.72668 35.4211 9.48543 35.6845 9.48902 36.1859C9.51973 40.4688 9.51176 44.7519 9.50499 49.0347C9.5006 51.7901 11.3353 53.813 14.7244 55.2103C16.2301 55.8312 17.7673 56.4166 19.2898 57.0189C23.3967 58.6438 27.5027 60.2689 31.62 61.8978ZM0.203846 39.1908C-0.239977 39.3524 -0.504349 39.4416 -0.759157 39.5426C-4.89512 41.1822 -9.01314 42.8437 -13.1706 44.457C-15.9396 45.5315 -17.366 47.1424 -17.3947 49.2935C-17.4454 53.0539 -17.4382 56.8149 -17.3971 60.5752C-17.3744 62.6528 -16.0019 64.2418 -13.3748 65.2884C-8.55537 67.2084 -3.74072 69.1341 1.10943 71.0172C3.50002 71.945 6.02618 71.9839 8.42514 71.065C12.8849 69.357 17.2832 67.5727 21.7043 65.8174C21.8834 65.7463 22.0377 65.6451 22.2435 65.537C21.9743 65.412 21.7905 65.3144 21.5907 65.2356C17.8244 63.7483 14.0632 62.2553 10.2865 60.7807C7.25117 59.5957 4.79599 58.0053 2.99039 55.9529C1.09348 53.7966 0.206238 51.4477 0.203846 48.936C0.201054 45.973 0.203043 43.0103 0.203043 40.0472C0.20384 39.7994 0.203846 39.5518 0.203846 39.1908ZM41.0427 65.5389C41.3928 65.6995 41.6508 65.8327 41.9284 65.9427C46.1513 67.6124 50.3753 69.2805 54.6022 70.9455C57.1754 71.9593 59.7945 71.9729 62.3538 70.9759C67.2263 69.0778 72.0704 67.1446 76.9062 65.2028C79.4312 64.1887 80.7156 62.6265 80.7403 60.6354C80.7874 56.8313 80.7958 53.0263 80.7371 49.2224C80.7052 47.158 79.3534 45.5731 76.6949 44.5301C72.9529 43.0622 69.232 41.569 65.4996 40.0899C64.7647 39.7986 64.017 39.5223 63.1413 39.188C63.1413 39.5453 63.1413 39.7901 63.1413 40.0352C63.1413 43.0879 63.1521 46.1404 63.1326 49.1931C63.1286 49.8042 63.0787 50.4227 62.9336 51.0245C61.9355 55.1668 58.8746 58.3735 53.6053 60.5446C51.3033 61.493 48.9597 62.3943 46.6358 63.3172C44.8018 64.0449 42.9695 64.7733 41.0427 65.5389ZM9.50698 28.1588C9.90495 28.0218 10.1681 27.9416 10.4165 27.8437C14.2702 26.3272 18.0975 24.7784 21.9795 23.2971C28.4071 20.8445 34.9077 20.87 41.3362 23.2668C45.2676 24.7324 49.0953 26.3288 52.9717 27.8637C53.2149 27.9599 53.4789 28.0322 53.788 28.1336C53.8103 27.9402 53.8346 27.8278 53.8346 27.7151C53.8366 24.1161 53.8394 20.5171 53.8302 16.9179C53.8294 16.6708 53.768 16.4197 53.6887 16.1776C53.1763 14.6206 51.8476 13.4813 49.8514 12.6924C45.1113 10.8195 40.3752 8.94162 35.6251 7.08044C32.9841 6.04562 30.3204 6.0686 27.679 7.09603C26.2658 7.64558 24.8629 8.20743 23.4565 8.76491C20.0403 10.1187 16.6006 11.4459 13.2163 12.836C10.7934 13.8312 9.51097 15.3288 9.50817 17.2959C9.50379 20.6443 9.50698 23.9928 9.50698 27.3415C9.50698 27.583 9.50698 27.8248 9.50698 28.1588Z"
            fill="white" />
        </svg>
      </div>
    </div>
  </div>

  <!-- Mokafaah Modal -->
  <div id="alrajhi-points-modal" tabindex="-1"
    class="fixed lg:top-0 top-1/4 left-0 right-0 z-50 hidden w-full p-5 overflow-x-hidden overflow-y-auto md:inset-0 max-h-full flex-shrink-0">
    <!-- Modal Content -->
    <div
      class="relative min-h-[300px] lg:w-[665px] w-full py-[25px] lg:px-[38px] px-4 bg-white flex flex-col gap-8 lg:gap-[54px] flex-shrink-0">
      <!-- Logo -->
      <div class="w-full flex flex-shrink-0 items-center justify-center lg:pb-0 pb-2">
        <img src="/images/payment/mokafaa-logo.png" class="w-[100px] h-[50px]" alt="Mokafaa-Logo">
      </div>
      <!-- Background image -->
      <div class="absolute top-0 rtl:left-0 ltr:right-0 ltr:scale-x-[-1] z-10">
        <svg xmlns="http://www.w3.org/2000/svg" width="185" height="273" viewBox="0 0 185 273" fill="none">
          <path
            d="M117.048 103.949C126.075 109.152 134.869 114.216 143.659 119.286C150.144 123.027 156.658 126.72 163.102 130.532C174.864 137.49 181.688 147.851 183.948 161.264C184.195 162.731 184.203 164.25 184.205 165.745C184.223 180.742 184.273 195.74 184.196 210.737C184.144 220.91 180.304 229.668 173.761 237.329C170.254 241.435 165.92 244.465 161.265 247.128C149.855 253.652 138.47 260.222 127.108 266.831C119.633 271.18 111.586 273.171 102.985 272.712C96.6818 272.375 90.6538 270.75 85.1568 267.605C70.4978 259.22 55.8758 250.771 41.2958 242.25C39.1578 241 37.5698 240.75 35.2428 242.121C20.9808 250.524 6.58079 258.693 -7.75021 266.979C-15.1632 271.265 -23.1522 273.16 -31.6602 272.715C-39.0282 272.329 -45.7642 269.867 -52.1132 266.149C-63.6702 259.38 -75.3852 252.876 -86.8542 245.962C-100.409 237.791 -107.714 225.71 -107.911 209.751C-108.088 195.422 -107.945 181.09 -107.949 166.759C-107.952 156.508 -104.412 147.574 -97.9082 139.749C-94.5142 135.666 -90.3452 132.553 -85.7532 129.918C-71.3962 121.677 -57.0972 113.334 -42.7212 105.125C-41.1692 104.239 -40.7452 103.252 -40.7502 101.585C-40.8012 84.5878 -41.0092 67.5868 -40.7132 50.5948C-40.4462 35.2868 -33.7592 23.1298 -20.7132 15.0118C-10.2652 8.50978 0.559792 2.61479 11.2288 -3.52921C14.0398 -5.14721 16.8518 -6.77221 19.7368 -8.25021C24.3008 -10.5892 29.1778 -11.7852 34.2948 -12.2942C43.7668 -13.2382 52.3928 -10.8892 60.5218 -6.1752C71.8918 0.418798 83.2418 7.04778 94.6878 13.5068C104.07 18.8018 110.67 26.3958 114.494 36.4318C116.167 40.8228 117.013 45.4028 117.028 50.0838C117.084 67.0808 117.05 84.0778 117.05 101.075C117.048 101.983 117.048 102.893 117.048 103.949ZM38.0018 213.811C38.3378 213.718 38.4258 213.712 38.4948 213.672C52.9038 205.368 67.4158 197.236 81.6768 188.686C89.5448 183.969 93.7088 176.704 93.7148 167.334C93.7248 151.427 93.6938 135.519 93.7528 119.612C93.7588 117.998 93.2848 117.103 91.8488 116.282C78.0598 108.402 64.3828 100.324 50.5418 92.5368C42.2118 87.8508 33.6378 88.0418 25.3328 92.7638C11.7438 100.491 -1.75322 108.381 -15.3332 116.125C-16.9012 117.019 -17.5062 117.982 -17.4972 119.815C-17.4202 135.472 -17.4402 151.13 -17.4572 166.787C-17.4682 176.86 -12.8672 184.255 -4.36819 189.363C-0.592194 191.633 3.26278 193.773 7.08078 195.975C17.3798 201.915 27.6768 207.856 38.0018 213.811ZM-40.7822 130.8C-41.8952 131.391 -42.5582 131.717 -43.1972 132.086C-53.5692 138.08 -63.8962 144.154 -74.3222 150.052C-81.2662 153.98 -84.8432 159.869 -84.9152 167.733C-85.0422 181.48 -85.0242 195.229 -84.9212 208.976C-84.8642 216.571 -81.4222 222.38 -74.8342 226.206C-62.7482 233.225 -50.6742 240.265 -38.5112 247.149C-32.5162 250.541 -26.1812 250.683 -20.1652 247.324C-8.98119 241.08 2.04877 234.557 13.1358 228.14C13.5848 227.88 13.9718 227.51 14.4878 227.115C13.8128 226.658 13.3518 226.301 12.8508 226.013C3.4058 220.576 -6.02622 215.118 -15.4972 209.727C-23.1092 205.395 -29.2662 199.581 -33.7942 192.078C-38.5512 184.195 -40.7762 175.608 -40.7822 166.426C-40.7892 155.594 -40.7842 144.763 -40.7842 133.931C-40.7822 133.025 -40.7822 132.12 -40.7822 130.8ZM61.6318 227.122C62.5098 227.709 63.1568 228.196 63.8528 228.598C74.4428 234.702 85.0358 240.8 95.6358 246.887C102.089 250.593 108.657 250.643 115.075 246.998C127.294 240.059 139.442 232.992 151.569 225.893C157.901 222.186 161.122 216.475 161.184 209.196C161.302 195.289 161.323 181.379 161.176 167.473C161.096 159.926 157.706 154.132 151.039 150.319C141.655 144.953 132.324 139.494 122.964 134.087C121.121 133.022 119.246 132.012 117.05 130.79C117.05 132.096 117.05 132.991 117.05 133.887C117.05 145.047 117.077 156.206 117.028 167.366C117.018 169.6 116.893 171.861 116.529 174.061C114.026 189.204 106.35 200.927 93.1358 208.864C87.3628 212.331 81.4858 215.626 75.6578 219C71.0588 221.66 66.4638 224.323 61.6318 227.122ZM-17.4522 90.4698C-16.4542 89.9688 -15.7942 89.6758 -15.1712 89.3178C-5.50723 83.7738 4.09077 78.1118 13.8258 72.6968C29.9448 63.7308 46.2468 63.8238 62.3678 72.5858C72.2268 77.9438 81.8258 83.7798 91.5468 89.3908C92.1568 89.7428 92.8188 90.0068 93.5938 90.3778C93.6498 89.6708 93.7108 89.2598 93.7108 88.8478C93.7158 75.6908 93.7228 62.5338 93.6998 49.3758C93.6978 48.4728 93.5438 47.5548 93.3448 46.6698C92.0598 40.9778 88.7278 36.8128 83.7218 33.9288C71.8348 27.0818 59.9578 20.2168 48.0458 13.4128C41.4228 9.62978 34.7428 9.71379 28.1188 13.4698C24.5748 15.4788 21.0568 17.5328 17.5298 19.5708C8.96281 24.5198 0.336823 29.3718 -8.15018 34.4538C-14.2262 38.0918 -17.4422 43.5668 -17.4492 50.7578C-17.4602 62.9988 -17.4522 75.2398 -17.4522 87.4818C-17.4522 88.3648 -17.4522 89.2488 -17.4522 90.4698Z"
            fill="#1D4ED8" fill-opacity="0.36" />
        </svg>
      </div>

      <!-- Send OTP Form -->
      <form v-if="active_form == 'send_otp'" class="z-30 w-full flex flex-col  gap-8 lg:gap-[54px]" action="#"
        @submit.prevent="sendOTP">
        <!-- Phone -->
        <Input input_style="h-[50px]" label_style="text-base lg:text-xl lg:pb-2 pb-1" v-model="phone"
          :label_name="$t('label_phone')" label_for="input-phone" input_id="input-phone" input_name="phone"
          input_type="text" input_dir="ltr" :input_phone_country="true" input_placeholder="534398859"
          @phone-country="getPhoneCountry" />

        <!-- Submit -->
        <button type="submit" :disabled="!phone"
          class="w-full rounded-md shadow bg-gray-900 h-[50px] flex justify-center items-center text-white font-bold text-base disabled:bg-gray-50 disabled:text-gray-500 disabled:cursor-not-allowed">
          {{ $t('btn_otp') }}
        </button>
      </form>

      <!-- Add Amount Form -->
      <form v-if="active_form == 'add_amount'" class="z-30 w-full flex flex-col  gap-8 lg:gap-[54px]" action="#"
        @submit.prevent="addAmount">
        <!-- OTP -->
        <Input input_style="h-[50px]" label_style="text-base lg:text-xl lg:pb-2 pb-1" v-model="otp"
          :label_name="$t('label_code')" label_for="input-otp" input_id="input-otp" input_name="otp" input_type="text" />
        <!-- Amount -->
        <Input input_style="h-[50px]" label_style="text-base lg:text-xl lg:pb-2 pb-1" v-model="amount"
          :label_name="$t('label_amount')" label_for="input-amount" input_id="input-amount" input_name="amount"
          input_type="text" :input_notes="true">
        <div class="flex justify-start items-center gap-[7px]">
          <span>
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="21" viewBox="0 0 20 21" fill="none">
              <path
                d="M10 6.92448V10.2578M10 13.5911H10.0083M17.5 10.2578C17.5 14.3999 14.1421 17.7578 10 17.7578C5.85786 17.7578 2.5 14.3999 2.5 10.2578C2.5 6.11568 5.85786 2.75781 10 2.75781C14.1421 2.75781 17.5 6.11568 17.5 10.2578Z"
                stroke="#6C6C6C" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </span>
          <span>
            {{ $t('mokafaah_amount_input_notes') }}
          </span>
        </div>
        </Input>

        <!-- Submit -->
        <button type="submit" :disabled="!otp || !amount"
          class="w-full rounded-md shadow bg-gray-900 h-[50px] flex justify-center items-center text-white font-bold text-base disabled:bg-gray-50 disabled:text-gray-500 disabled:cursor-not-allowed">
          {{ $t('btn_add_amount') }}
        </button>
      </form>

      <!-- Success Alert -->
      <div v-if="active_form == 'success_alert'" class="z-30 lg:pb-[50px] w-full flex flex-col gap-[39px] lg:gap-[43px]">
        <div class="flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="61" height="61" viewBox="0 0 61 61" fill="none">
            <path
              d="M30.5 60.5C47.0685 60.5 60.5 47.0685 60.5 30.5C60.5 13.9315 47.0685 0.5 30.5 0.5C13.9315 0.5 0.5 13.9315 0.5 30.5C0.5 47.0685 13.9315 60.5 30.5 60.5Z"
              fill="#374151" />
            <path
              d="M44.8068 17.9705C45.0741 17.6765 45.397 17.4385 45.757 17.2703C46.1169 17.1021 46.5067 17.0071 46.9036 16.9908C47.3006 16.9745 47.6968 17.0372 48.0694 17.1753C48.4419 17.3133 48.7833 17.524 49.0738 17.7951C49.3642 18.0662 49.5979 18.3922 49.7613 18.7544C49.9247 19.1165 50.0146 19.5075 50.0257 19.9046C50.0367 20.3018 49.9688 20.6972 49.8259 21.0678C49.6829 21.4385 49.4677 21.7771 49.1928 22.064L28.1928 44.564C27.6649 45.1297 26.9389 45.4696 26.1663 45.5127C25.3937 45.5557 24.6343 45.2986 24.0468 44.795L13.5468 35.795C12.9718 35.2696 12.6236 34.5412 12.5759 33.7637C12.5283 32.9863 12.7848 32.2208 13.2914 31.6291C13.7979 31.0374 14.5147 30.6659 15.2903 30.5932C16.0658 30.5205 16.8391 30.7523 17.4468 31.2395L25.7628 38.3675L44.8068 17.9705Z"
              fill="#F9FAFB" />
          </svg>
        </div>
        <span
          class="w-full flex items-center justify-center text-gray-800 font-bold lg:font-extrabold text-[17px] lg:text-xl">
          {{ $t('mokafaah_success_alert_1') }} {{ '30 ريال' }} {{ $t('mokafaah_success_alert_2') }}
        </span>
      </div>

    </div>
  </div>
</template>

<script setup>
import { Modal } from 'flowbite';
const emits = defineEmits([''])
const props = defineProps({})

const modal = ref('')
onMounted(
  () => {

    const modalTarget = document.getElementById('alrajhi-points-modal');
    const modalOptions = {
      placement: 'center',
      backdrop: 'dynamic',
      backdropClasses: 'bg-gray-900 bg-opacity-50 dark:bg-opacity-80 fixed inset-0 z-40',
      closable: true,
    }
    modal.value = new Modal(modalTarget, modalOptions)
  }
)
const active_form = ref('send_otp')
const phone_country = ref('+966')
const phone = ref('')
const otp = ref('')
const amount = ref('')

function getPhoneCountry(code) {
  phone_country.value = code
}

function sendOTP() {
  var formBody = {
    phone_country: phone_country.value,
    phone: phone.value,
  }
  console.log(formBody)
  active_form.value = 'add_amount'
}

function addAmount() {
  var formBody = {
    otp: otp.value,
    amount: amount.value,
  }
  console.log(formBody)
  active_form.value = 'success_alert'
}

</script>